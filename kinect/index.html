<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Kinect - Spatial Auditory Feedback</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Kinect";
        var mkdocs_page_input_path = "kinect.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Spatial Auditory Feedback
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Kinect</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#programs">Programs</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#prelude">Prelude</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#fun-stuff">Fun Stuff</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#openpose">OpenPose</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#distrobox-installation">Distrobox Installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#openpose-installation">OpenPose installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ros-installation">ROS Installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#kinect-bridge-installation">Kinect Bridge Installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ros-openpose-installation">ROS OpenPose Installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#uninstalling-openpose">Uninstalling OpenPose</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../processing/">Processing</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ios/">iOS</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Spatial Auditory Feedback</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Kinect</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="kinect">Kinect</h1>
<h2 id="introduction">Introduction</h2>
<p>The Kinect for Xbox 360 (also known as the Kinect v1) was developed by <a href="https://github.com/PrimeSense">PrimeSense</a> in collaboration with <a href="https://github.com/OpenNI">OpenNI</a>. A couple years later, Microsoft began development on the Kinect for Xbox One (also known as the Kinect v2). Additionally, PrimeSense who made the original Kinect was aquired by Apple.</p>
<p>While the Kinect v2 was designed for PC's and the Xbox One, many open-source developers continued the development of the Kinect v2 drivers which still obtain data aquisition via the OpenNI2 drivers. <a href="https://github.com/OpenKinect/libfreenect2">Libfreenect2</a>, a wrapper library, was written for obtaining the RGB and depth data which depends on the OpenNI2 drivers. This library is what the submodule in the <a href="https://github.gatech.edu/L42i/spatial-auditory-feedback/tree/main/Kinect"><code>Kinect</code></a> folder points to, and it contains all of the software one needs to control/view data from the Kinect v2 sensor. It does not contain the software which performs pose tracking.</p>
<p>However, because the data retrieved by the OpenNI2 drivers is similar to that of the OpenNI drivers written for the Kinect v1, it is possible to use the old tracking algorithms created by PrimeSense known as NiTE. A future goal of the Spatial Auditory Feedback project is to use open-source pose tracking algorithms, such as <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose">OpenPose</a>, <a href="https://github.com/google-ai-edge/mediapipe">MediaPipe</a>, or <a href="https://github.com/joaquimrocha/Skeltrack">Skeltrack</a> which was designed specifically for the Kinect v2.</p>
<p>Further exploration and testing is needed here. For now, the installation guide on the next page will cover installing libfreenect2 and the NiTE2.2 shared library.</p>
<h2 id="installation">Installation</h2>
<p>Step 1: Update the package list</p>
<pre><code class="language-shell">sudo apt update
</code></pre>
<p>Step 2: Install build tools:</p>
<pre><code class="language-shell">sudo apt install build-essential cmake pkg-config
</code></pre>
<p>Step 3: Install libusb (for getting the Kinect to talk to the USB ports)</p>
<pre><code class="language-shell">sudo apt install libusb-1.0-0-dev
</code></pre>
<p>Step 4: Install graphics libraries (for displaying the camera output from the sensor)</p>
<pre><code class="language-shell">sudo apt install libturbojpeg0-dev libglfw3-dev
</code></pre>
<p>Step 5: Install OpenNI2 libraries/tools (they will be needed later for testing and installation of libfreenect2)</p>
<pre><code class="language-shell">sudo apt install libopenni2-dev openni2-utils
</code></pre>
<p>Step 6: Clone libfreenect2 and enter the directory</p>
<pre><code class="language-shell">git clone https://github.com/OpenKinect/libfreenect2.git
cd libfreenect2
</code></pre>
<p>Step 7: Build and install the libfreenect2 library from source</p>
<pre><code class="language-shell">mkdir build &amp;&amp; cd build
cmake .. -DCMAKE_INSTALL_PREFIX=$HOME/freenect2
make
make install
</code></pre>
<p><strong>Note: You need to specify <code>cmake -Dfreenect2_DIR=$HOME/freenect2/lib/cmake/freenect2</code> for CMake based third-party application to find libfreenect2.</strong></p>
<p>Step 8: Install the openni2 library from here</p>
<pre><code class="language-shell">sudo make install-openni2
</code></pre>
<p>Step 9: Set up udev rules for device access.</p>
<pre><code class="language-shell">sudo cp ../platform/linux/udev/90-kinect2.rules /etc/udev/rules.d/
</code></pre>
<p><strong>Note: If any Kinects were plugged into the USB ports, each one needs to be re-plugged again for the USB to recognize it with the updated rules.</strong></p>
<p>Step 10: Create symbolic links to installed libraries which are missing and required for everything to work.</p>
<pre><code class="language-shell">sudo ln -s /usr/lib/x86_64-linux-gnu/OpenNI2/Drivers/libfreenect2-openni2.so /usr/lib/x86_64-linux-gnu/OpenNI2/Drivers/libFreenectDriver.so
sudo ln -s /usr/lib/x86_64-linux-gnu/OpenNI2/Drivers/libfreenect2-openni2.so.0 /usr/lib/x86_64-linux-gnu/OpenNI2/Drivers/libFreenectDriver.so.0
</code></pre>
<p><strong>Note: Remember these paths, and make sure they exist. They will be needed when we run the NiTE tracker in the next steps below. See: <a href="https://github.com/OpenKinect/libfreenect2/issues/639">https://github.com/OpenKinect/libfreenect2/issues/639</a> for more context.</strong></p>
<h2 id="programs">Programs</h2>
<h3 id="prelude">Prelude</h3>
<p>There are a couple items to complete before having fun with the Kinect sensors. Some of these you may need to do every time you boot the system. Others may be a one-time checklist item.</p>
<ul>
<li>Run <code>lsusb</code> and make sure each Kinect is attached to a bus which is on a USB 3.0 root controller. USB 3.0 is required for the Kinect Xbox One (Kinect v2)</li>
<li>Download and unzip the NiTE tracking library by PrimeSense archived here: <a href="https://bitbucket.org/kaorun55/openni-2.2/src/2f54272802bfd24ca32f03327fbabaf85ac4a5c4/NITE%202.2%20%CE%B1/?at=master">https://bitbucket.org/kaorun55/openni-2.2/src/2f54272802bfd24ca32f03327fbabaf85ac4a5c4/NITE%202.2%20%CE%B1/?at=master</a>. Rich 133B has a 64-bit Linux system, so it should be the x64-Linux one.</li>
<li>Remember the last note about those paths? This is where they are needed. Open the file located in the downloaded NiTE package as described below:</li>
</ul>
<pre><code class="language-shell">cd ~/Downloads/NiTE-Linux-x64-2.2/Samples/Bin
sudo nano OpenNI.ini
</code></pre>
<ul>
<li>
<p>Uncomment the line ';Repository=OpenNI2/Drivers' by removing the ';' and set repository to the path. It should look something like this:
<code>Repository=/usr/lib/x86_64-linux-gnu/OpenNI2/Drivers</code>. Save the file and exit.</p>
</li>
<li>
<p>Set the UBFS buffer size to 32MB (this one is required on every boot). Otherwise libusb will not have enough memory, as the default on system boot is 16MB. Each Kinect v2 sensor uses 16MB which adds up to 32MB total. Read this guide for more info on how to calculate the memory: <a href="https://www.flir.com/support-center/iis/machine-vision/application-note/understanding-usbfs-on-linux/?srsltid=AfmBOood-y0AC2UhSXvvTEc693SOaK5ANXoG_BEoVPKJCJtMeKu25VND">Understanding USBFS on Linux</a>.</p>
</li>
</ul>
<pre><code class="language-shell">sudo sh -c 'echo 32 &gt; /sys/module/usbcore/parameters/usbfs_memory_mb'
</code></pre>
<h3 id="fun-stuff">Fun Stuff</h3>
<p>Now any of the OpenNI2, libfreenect2, and NiTE programs should be able to run with the Kinects! The OpenNI2 programs should be in your path.</p>
<ul>
<li>The OpenNI2 programs are listed in <a href="https://github.com/OpenNI/OpenNI2/tree/master/Samples">https://github.com/OpenNI/OpenNI2/tree/master/Samples</a></li>
<li>The libfreenect2 program is in <code>/path/to/libfreenect2/build/bin/</code>. It can be run via <code>./path/to/libfreenect2/build/bin/Protonect</code>.</li>
<li>The NiTE programs are in <code>/path/to/NiTE-Linux-x64-2.2/Samples/Bin</code>. The one which shows the tracked skeleton is called <code>UserViewer</code> and can be run via <code>./path/to/NiTE-Linux-x64-2.2/Samples/Bin/UserViewer</code>. Note this program was intended for the original Kinect v1 sensor, so it doesn't perform optimally with the Kinect v2 sensors due to the down-scaled resolution. Further investigation on an alternative skeleton tracking method is in progress.</li>
</ul>
<h2 id="openpose">OpenPose</h2>
<p><img alt="OpenPose" src="../openpose.png" /></p>
<p>The real question is what new solutions are out there for skeleton tracking using the Kinectv2 sensor? The following tutorial will guide you through installing a Kinect v2 compatible solution for Carnegie Mellon University's library for skeleton tracking called <a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose">OpenPose</a>.</p>
<h3 id="distrobox-installation">Distrobox Installation</h3>
<p>Many of the packages used for the Kinect are not supported on later distro versions anymore, so it would be nice to setup some sort of container which can hold and run our work. This is the perfect job for Docker, a package which allows the containerization of a Ubuntu image -- or pretty much any Linux distro for that matter. Docker has a nice wrapper which makes the job even easier called <a href="https://wiki.archlinux.org/title/Distrobox">Distrobox</a>. It can be installed with aptitude via the following command:</p>
<pre><code class="language-shell">sudo apt install distrobox
</code></pre>
<p>A container can be created with a name and an image in a registry, such as the docker.io registry. Example url: docker.io/barebuild/ubuntu:14.04. In this installation, we will use the official Ubuntu 20.04 distro which is the latest compatible distro for this installation. Then we can give the container a name we will remember for our use case, such as kinectubuntu.</p>
<pre><code class="language-shell">distrobox create --name kinectubuntu --image ubuntu:20.04
</code></pre>
<p>Then you can enter the container you created using:</p>
<pre><code class="language-shell">distrobox enter kinectubuntu
</code></pre>
<p>After this command, you should see something like this:</p>
<pre><code class="language-shell">evan@evanmurray-MBP:~$ distrobox enter kinectubuntu
Starting container...                            [ OK ]
Installing basic packages...                     [ OK ]
Setting up devpts mounts...                      [ OK ]
Setting up read-only mounts...                   [ OK ]
Setting up read-write mounts...                  [ OK ]
Setting up host's sockets integration...         [ OK ]
Integrating host's themes, icons, fonts...       [ OK ]
Setting up package manager exceptions...         [ OK ]
Setting up package manager hooks...              [ OK ]
Setting up dpkg exceptions...                    [ OK ]
Setting up apt hooks...                          [ OK ]
Setting up distrobox profile...                  [ OK ]
Setting up sudo...                               [ OK ]
Setting up user groups...                        [ OK ]
Setting up kerberos integration...               [ OK ]
Setting up user's group list...                  [ OK ]
Setting up user home...                          [ OK ]
Ensuring user's access...                        [ OK ]

Container Setup Complete!
evan@kinectubuntu:~$
</code></pre>
<p>Notice how now the hostname is the name of the container. You should now install this package, as it will be needed later. You can also use it to verify the version of Ubuntu.</p>
<pre><code class="language-shell">evan@kinectubuntu:~$ sudo apt install lsb-release
evan@kinectubuntu:~$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 20.04.6 LTS
Release:        20.04
Codename:       focal
evan@kinectubuntu:~$
</code></pre>
<p>You'll also want to install <code>nano</code> and <code>git</code>. Nano can be used as a text editor, and git can be used for cloning some required repositories for this installation.</p>
<pre><code class="language-shell">sudo apt install nano git
</code></pre>
<h3 id="openpose-installation">OpenPose installation</h3>
<p>First, you'll want to install the OpenCV development libraries and create a symlink for opencv2 to find opencv4.</p>
<pre><code class="language-shell">sudo apt install libopencv-dev
sudo ln -s /usr/include/opencv4/opencv2 /usr/include/opencv2
</code></pre>
<p>You'll also want to install the CMake GUI built with Qt to build the OpenPose project.</p>
<pre><code class="language-shell">sudo apt install cmake-qt-gui
</code></pre>
<p>Then, since the Caffe machine learning models with the default version of OpenPose have issues, you can clone this fork to install them correctly. We'll also want to initialize the submodules.</p>
<pre><code class="language-shell">git clone https://github.com/AlecDusheck/openpose.git
cd openpose
git submodule update --init --recursive --remote
</code></pre>
<p>Now that we've cloned the repo, you can run this script to install the OpenPose dependencies:</p>
<pre><code class="language-shell">sudo bash ./scripts/ubuntu/install_deps.sh
</code></pre>
<p>Then create the build directory, go to it, and run configure to download the Caffe models.</p>
<pre><code class="language-shell">mkdir build
cd build
cmake-gui ..
</code></pre>
<p>A window should pop up which looks like this. Make sure the source folder is set to the root of OpenPose and the build folder is set to the build folder you just created.</p>
<p><img alt="CMakeWindow" src="../CmakeGui1.png" /></p>
<p>Now click the Configure button and make sure the generator is set to "Unix Makefiles".</p>
<p><img alt="CMakeSetup" src="../CMakeSetup.png" /></p>
<p>Don't worry, once you run this step--configure should fail for the first time.</p>
<p><img alt="CMakeError" src="../CMakeError.png" /></p>
<p>This is because we haven't specified how to install CUDA yet. This will be covered in a later tutorial. For now, you can set the GPU_MODE flag to CPU_ONLY as below:</p>
<p><img alt="CPUOnly" src="../CPUOnly.png" /></p>
<p>Now run configure again to download the Caffe models. You should see "Configuring done" at the bottom of the console when it completes.</p>
<p>Now navigate to the root of your OpenPose folder and go to the models folder. Copy the three files located there to a convenient place, as they will be needed later:</p>
<pre><code>/home/evan/openpose/models/pose/body_25/pose_iter_584000.caffemodel
/home/evan/openpose/models/hand/pose_iter_102000.caffemodel
/home/evan/openpose/models/face/pose_iter_116000.caffemodel
</code></pre>
<p>Now, delete your OpenPose folder. This may seem counter-intuitive, but you'll see why. Clone the OpenPose from the official CMU repo:</p>
<pre><code class="language-shell">git clone https://github.com/CMU-Perceptual-Computing-Lab/openpose.git
</code></pre>
<p>Now you should checkout version 1.7.0, as this is the latest supported version by another tool we will use.</p>
<pre><code class="language-shell">cd openpose
git checkout tags/v1.7.0
</code></pre>
<p>Now, follow the same steps we followed for the previous OpenPose repo. On the second CMake configure, you will get another error.</p>
<pre><code>CMake Error at cmake/Utils.cmake:8 (file):
  file DOWNLOAD HASH mismatch

    for file: [/home/evan/openpose/models/pose/body_25/pose_iter_584000.caffemodel]
      expected hash: [78287b57cf85fa89c03f1393d368e5b7]
        actual hash: [d41d8cd98f00b204e9800998ecf8427e]
             status: [7;&quot;Couldn't connect to server&quot;]

Call Stack (most recent call first):
  CMakeLists.txt:994 (download_model)
</code></pre>
<p>This is why we used the other repo to download the models. Now locate those models, and copy each one to the correct directory to replace the existing model file there (which should be 0B in size since it failed to download). Once that's done, run configure again, and it should successfully complete this time. Now click the "Generate" button to generate the build files.</p>
<p>Now run this make command to make OpenPose:</p>
<pre><code class="language-shell">make -j`nproc`
</code></pre>
<p>Then run this to install the library on the system:</p>
<pre><code class="language-shell">sudo make install
</code></pre>
<h3 id="ros-installation">ROS Installation</h3>
<p>First, add this source to your sources file to download the ROS packages:</p>
<pre><code class="language-shell">sudo sh -c 'echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list'
</code></pre>
<p>Then add it to your keys:</p>
<pre><code class="language-shell">curl -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | sudo apt-key add -
</code></pre>
<p>Now update your package index:</p>
<pre><code class="language-shell">sudo apt update
</code></pre>
<p>Now install ROS noetic:</p>
<pre><code class="language-shell">sudo apt install ros-noetic-desktop-full
</code></pre>
<p>Now activate the ROS environment:</p>
<pre><code>source /opt/ros/noetic/setup.bash
</code></pre>
<p>Install and initialize ROS dependencies</p>
<pre><code class="language-shell">sudo apt install python3-rosdep python3-rosinstall python3-rosinstall-generator python3-wstool build-essential
sudo apt install python3-rosdep
sudo rosdep init
rosdep update
</code></pre>
<p>Now create and initialize catkin workspace via the following commands:</p>
<pre><code class="language-shell">mkdir -p ~/catkin_ws/src
cd ~/catkin_ws/
catkin_make
source devel/setup.bash
</code></pre>
<p>Copy the contents of this script and paste it in a file called <code>fix_cpp.py</code> to fix the CMake files later: <a href="https://gist.githubusercontent.com/Meltwin/1ee35296d2bb86fee19d639580e3c91f/raw/13b8d626733981cdf58244708e5cba1ee5d87e1c/change_cpp.py">https://gist.githubusercontent.com/Meltwin/1ee35296d2bb86fee19d639580e3c91f/raw/13b8d626733981cdf58244708e5cba1ee5d87e1c/change_cpp.py</a></p>
<pre><code class="language-shell">sudo nano fix_cpp.py
</code></pre>
<h3 id="kinect-bridge-installation">Kinect Bridge Installation</h3>
<p>If you've followed the steps <a href="#installation">above</a>, you should already have libfreenect2 installed. However, you may want to re-install it in the container since some of the dependencies won't be installed. You can do so by removing the libfreenect2 and freenect2 folders and re-following the installation steps inside the container. You can skip step 9 since the container looks to the host for usb devices. You can also skip step 10 since it's already been done, and again the container relies on the host system for these libraries.</p>
<p>Go to the <code>src</code> directory and clone the kinect bridge repo there:</p>
<pre><code class="language-shell">cd src
git clone https://github.com/code-iai/iai_kinect2.git
</code></pre>
<p>Go to the repo directory and install all the ROS dependencies.</p>
<pre><code class="language-shell">cd iai_kinect2
rosdep install -r --from-paths .
</code></pre>
<p>Temporarily move the CMakeLists.txt file at the root of <code>src</code> directory somewhere else, and run the <code>fix_cpp.py</code> script at the root of the workspace.</p>
<pre><code class="language-shell">cd ~/catkin_ws
python3 fix_cpp.py
</code></pre>
<p>You should see something like this:</p>
<pre><code class="language-shell">evan@kinectubuntu:~/catkin_ws$ python3 fix_cpp.py
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                     CMakeLists to C++17 Utils                                      ┃
┃                                           Meltwin - 2023                                           ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

▷ Found ./src/iai_kinect2/iai_kinect2/CMakeLists.txt Nothing to change
▷ Found ./src/iai_kinect2/kinect2_calibration/CMakeLists.txt Fixed !
▷ Found ./src/iai_kinect2/kinect2_bridge/CMakeLists.txt Fixed !
▷ Found ./src/iai_kinect2/kinect2_viewer/CMakeLists.txt Fixed !
▷ Found ./src/iai_kinect2/kinect2_registration/CMakeLists.txt Fixed !
evan@kinectubuntu:~/catkin_ws$
</code></pre>
<p>Next, move the CMakeLists.txt back and build the package via the following command:</p>
<pre><code class="language-shell">catkin_make -DCMAKE_BUILD_TYPE=&quot;Release&quot;
</code></pre>
<p>You'll get a bunch of errors, but don't worry. We will fix them now. Do the following:</p>
<ul>
<li>Open up the file(s) where the error occurs</li>
<li>Replace all occurences of <code>CV_IMWRITE_PNG_COMPRESSION</code> with <code>cv::IMWRITE_PNG_COMPRESSION</code></li>
<li>Replace all occurences of <code>CV_IMWRITE_JPEG_QUALITY</code> with <code>cv::IMWRITE_JPEG_QUALITY</code></li>
<li>Replace all occurences of <code>CV_IMWRITE_PNG_STRATEGY</code> with <code>cv::IMWRITE_PNG_STRATEGY</code></li>
<li>Replace all occurences of <code>CV_IMWRITE_PNG_STRATEGY_RLE</code> with <code>cv::IMWRITE_PNG_STRATEGY_RLE</code></li>
<li>Replace all occurences of <code>CV_BGRA2BGR</code> with <code>cv::COLOR_BGRA2BGR</code></li>
<li>Replace all occurences of <code>CV_RGBA2BGR</code> with <code>cv::COLOR_RGBA2BGR</code></li>
<li>Replace all occurences of <code>CV_BGR2GRAY</code> with <code>cv::COLOR_BGR2GRAY</code></li>
<li>Replace all occurences of <code>CV_AA</code> with <code>cv::LINE_AA</code></li>
</ul>
<p>Now save all the files, run the command again, and it should build successfully!</p>
<h3 id="ros-openpose-installation">ROS OpenPose Installation</h3>
<p>Go back to the <code>src</code> folder of the catkin workspace and clone another repo.</p>
<pre><code class="language-shell">cd src
git clone https://github.com/ravijo/ros_openpose.git
</code></pre>
<p>Go to the repo directory and install all the ROS dependencies.</p>
<pre><code class="language-shell">cd ros_openpose
rosdep install -r --from-paths .
</code></pre>
<p>Temporarily move the CMakeLists.txt file at the root of <code>src</code> directory somewhere else, and run the <code>fix_cpp.py</code> script at the root of the workspace.</p>
<pre><code class="language-shell">cd ~/catkin_ws
python3 fix_cpp.py
</code></pre>
<p>You should see something like this:</p>
<pre><code class="language-shell">evan@kinectubuntu:~/catkin_ws$ python3 fix_cpp.py
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                                     CMakeLists to C++17 Utils                                      ┃
┃                                           Meltwin - 2023                                           ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

▷ Found ./src/iai_kinect2/iai_kinect2/CMakeLists.txt Nothing to change
▷ Found ./src/iai_kinect2/kinect2_calibration/CMakeLists.txt Nothing to change
▷ Found ./src/iai_kinect2/kinect2_bridge/CMakeLists.txt Nothing to change
▷ Found ./src/iai_kinect2/kinect2_viewer/CMakeLists.txt Nothing to change
▷ Found ./src/iai_kinect2/kinect2_registration/CMakeLists.txt Nothing to change
▷ Found ./src/ros_openpose/CMakeLists.txt Fixed !
evan@kinectubuntu:~/catkin_ws$
</code></pre>
<p>Now move the CMakeLists.txt file back and run the make command at the root of the workspace to build the package.</p>
<pre><code class="language-shell">catkin_make
</code></pre>
<p>Next, go to the scripts folder of the ros openpose and make all the files executable.</p>
<pre><code class="language-shell">roscd ros_openpose/scripts
chmod +x *.py
</code></pre>
<p>Now, install this python package to allow the visualizer to correctly work.</p>
<pre><code class="language-shell">sudo apt install python-is-python3
</code></pre>
<p>Make sure the kinects are connected to the computer and run this command to launch the visualizer:</p>
<pre><code class="language-shell">roslaunch ros_openpose run.launch camera:=kinect
</code></pre>
<h3 id="uninstalling-openpose">Uninstalling OpenPose</h3>
<p>Since we installed everything in the Distrobox container, this is fairly simple.</p>
<p>Step 1 is to remove all of the folders you git cloned for the project.</p>
<pre><code class="language-shell">cd ~
sudo rm -r catkin_ws
sudo rm -r openpose
sudo rm -r libfreenect2
sudo rm -r freenect2
</code></pre>
<p>Then, exit the container via the <code>logout</code> command. It should look something like this.</p>
<pre><code class="language-shell">evan@kinectubuntu:~$ logout
evan@evanmurray-MBP:~$
</code></pre>
<p>Notice how now the host has changed back to our actual hostname. You can now stop the container and remove it.</p>
<pre><code class="language-shell">distrobox stop kinectubuntu
distrobox rm kinectubuntu
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../processing/" class="btn btn-neutral float-right" title="Processing">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../processing/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
